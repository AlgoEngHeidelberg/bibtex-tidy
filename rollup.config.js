/* jshint node: true, esversion: 6, unused: true */
import commonjs from '@rollup/plugin-commonjs';
import nodeResolve from '@rollup/plugin-node-resolve';
import dsv from '@rollup/plugin-dsv';
import typescript from '@rollup/plugin-typescript';
import { version } from './package.json';
import babel from 'rollup-plugin-babel';

const tsv = {
	processRow(row) {
		return [row.unicode, row.latex];
	},
};

const banner = `/**
 * bibtex-tidy v${version}
 * https://github.com/FlamingTempura/bibtex-tidy
 * 
 * DO NOT EDIT THIS FILE. This file is automatically generated 
 * using \`npm run build\`. Edit files in './src' then rebuild.
 **/`;

const babelcfg = {
	presets: [
		[
			'@babel/env',
			{
				targets: {
					edge: '17',
					firefox: '60',
					chrome: '67',
					safari: '11.1',
				},
			},
		],
	],
};

export default {
	input: 'src/index.ts',
	plugins: [typescript(), dsv(tsv), commonjs(), nodeResolve(), babel(babelcfg)],
	output: {
		name: 'bibtexTidy',
		file: 'bibtex-tidy.js',
		format: 'umd',
		banner,
	},
};
